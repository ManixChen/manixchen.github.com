import{ak as P,al as xe,am as oe,an as Le,ao as Ce,b as we,d as G,a4 as he,i as de,e as le,ap as ge,aq as Te,ar as ze,as as be,u as ke,at as Ne,r as C,au as Oe,C as Re,f as E,w as fe,aj as Ie,F as Ee,o as L,j as me,x as p,k as $,v as x,p as h,h as n,n as ve,L as $e,O as A,E as D,ac as Ae,g as B,Q as ie,M as Be,P as Me,av as Ve,aw as Fe,l as De,ax as Pe,ay as Xe,R as Ye,K as We,N as He,m as se,T as je,az as Ke,_ as Se,aA as q,aB as U,aC as qe,t as _e,aD as Ue,a5 as Ze,aE as Ge,q as Qe,S as Je,aF as et}from"./index-Cv3_oK_S.js";import{u as tt}from"./index-BwMd8_OJ.js";const nt=(e,s)=>{if(!P||!e||!s)return!1;const t=e.getBoundingClientRect();let u;return s instanceof Element?u=s.getBoundingClientRect():u={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<u.bottom&&t.bottom>u.top&&t.right>u.left&&t.left<u.right};var at=/\s/;function rt(e){for(var s=e.length;s--&&at.test(e.charAt(s)););return s}var st=/^\s+/;function ot(e){return e&&e.slice(0,rt(e)+1).replace(st,"")}var pe=NaN,it=/^[-+]0x[0-9a-f]+$/i,lt=/^0b[01]+$/i,ut=/^0o[0-7]+$/i,ct=parseInt;function ye(e){if(typeof e=="number")return e;if(xe(e))return pe;if(oe(e)){var s=typeof e.valueOf=="function"?e.valueOf():e;e=oe(s)?s+"":s}if(typeof e!="string")return e===0?e:+e;e=ot(e);var t=lt.test(e);return t||ut.test(e)?ct(e.slice(2),t?2:8):it.test(e)?pe:+e}var ue=function(){return Le.Date.now()},dt="Expected a function",ft=Math.max,mt=Math.min;function vt(e,s,t){var u,i,v,O,o,I,y=0,S=!1,_=!1,w=!0;if(typeof e!="function")throw new TypeError(dt);s=ye(s)||0,oe(t)&&(S=!!t.leading,_="maxWait"in t,v=_?ft(ye(t.maxWait)||0,s):v,w="trailing"in t?!!t.trailing:w);function f(c){var b=u,T=i;return u=i=void 0,y=c,O=e.apply(T,b),O}function M(c){return y=c,o=setTimeout(F,s),S?f(c):O}function d(c){var b=c-I,T=c-y,j=s-b;return _?mt(j,v-T):j}function V(c){var b=c-I,T=c-y;return I===void 0||b>=s||b<0||_&&T>=v}function F(){var c=ue();if(V(c))return X(c);o=setTimeout(F,d(c))}function X(c){return o=void 0,w&&u?f(c):(u=i=void 0,O)}function H(){o!==void 0&&clearTimeout(o),y=0,u=I=i=o=void 0}function Y(){return o===void 0?O:X(ue())}function W(){var c=ue(),b=V(c);if(u=arguments,i=this,I=c,b){if(o===void 0)return M(I);if(_)return clearTimeout(o),o=setTimeout(F,s),f(I)}return o===void 0&&(o=setTimeout(F,s)),O}return W.cancel=H,W.flush=Y,W}var gt="Expected a function";function ce(e,s,t){var u=!0,i=!0;if(typeof e!="function")throw new TypeError(gt);return oe(t)&&(u="leading"in t?!!t.leading:u,i="trailing"in t?!!t.trailing:i),vt(e,s,{leading:u,maxWait:s,trailing:i})}const pt=(e,s)=>{if(!P)return!1;const t={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(s)],u=Ce(e,t);return["scroll","auto","overlay"].some(i=>u.includes(i))},yt=(e,s)=>{if(!P)return;let t=e;for(;t;){if([window,document,document.documentElement].includes(t))return window;if(pt(t,s))return t;t=t.parentNode}return t},wt=we({urlList:{type:G(Array),default:()=>he([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:G(String)}}),ht={close:()=>!0,switch:e=>de(e),rotate:e=>de(e)},bt=["src","crossorigin"],kt=le({name:"ElImageViewer"}),It=le({...kt,props:wt,emits:ht,setup(e,{expose:s,emit:t}){var u;const i=e,v={CONTAIN:{name:"contain",icon:ge(Te)},ORIGINAL:{name:"original",icon:ge(ze)}},{t:O}=be(),o=ke("image-viewer"),{nextZIndex:I}=Ne(),y=C(),S=C([]),_=Oe(),w=C(!0),f=C(i.initialIndex),M=Re(v.CONTAIN),d=C({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=C((u=i.zIndex)!=null?u:I()),F=E(()=>{const{urlList:r}=i;return r.length<=1}),X=E(()=>f.value===0),H=E(()=>f.value===i.urlList.length-1),Y=E(()=>i.urlList[f.value]),W=E(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!i.infinite&&X.value)]),c=E(()=>[o.e("btn"),o.e("next"),o.is("disabled",!i.infinite&&H.value)]),b=E(()=>{const{scale:r,deg:l,offsetX:m,offsetY:z,enableTransition:R}=d.value;let k=m/r,N=z/r;switch(l%360){case 90:case-270:[k,N]=[N,-k];break;case 180:case-180:[k,N]=[-k,-N];break;case 270:case-90:[k,N]=[-N,k];break}const K={transform:`scale(${r}) rotate(${l}deg) translate(${k}px, ${N}px)`,transition:R?"transform .3s":""};return M.value.name===v.CONTAIN.name&&(K.maxWidth=K.maxHeight="100%"),K});function T(){Q(),t("close")}function j(){const r=ce(m=>{switch(m.code){case q.esc:i.closeOnPressEscape&&T();break;case q.space:ae();break;case q.left:re();break;case q.up:g("zoomIn");break;case q.right:a();break;case q.down:g("zoomOut");break}}),l=ce(m=>{const z=m.deltaY||m.deltaX;g(z<0?"zoomIn":"zoomOut",{zoomRate:i.zoomRate,enableTransition:!1})});_.run(()=>{U(document,"keydown",r),U(document,"wheel",l)})}function Q(){_.stop()}function J(){w.value=!1}function ee(r){w.value=!1,r.target.alt=O("el.image.error")}function te(r){if(w.value||r.button!==0||!y.value)return;d.value.enableTransition=!1;const{offsetX:l,offsetY:m}=d.value,z=r.pageX,R=r.pageY,k=ce(K=>{d.value={...d.value,offsetX:l+K.pageX-z,offsetY:m+K.pageY-R}}),N=U(document,"mousemove",k);U(document,"mouseup",()=>{N()}),r.preventDefault()}function ne(){d.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ae(){if(w.value)return;const r=qe(v),l=Object.values(v),m=M.value.name,R=(l.findIndex(k=>k.name===m)+1)%r.length;M.value=v[r[R]],ne()}function Z(r){const l=i.urlList.length;f.value=(r+l)%l}function re(){X.value&&!i.infinite||Z(f.value-1)}function a(){H.value&&!i.infinite||Z(f.value+1)}function g(r,l={}){if(w.value)return;const{minScale:m,maxScale:z}=i,{zoomRate:R,rotateDeg:k,enableTransition:N}={zoomRate:i.zoomRate,rotateDeg:90,enableTransition:!0,...l};switch(r){case"zoomOut":d.value.scale>m&&(d.value.scale=Number.parseFloat((d.value.scale/R).toFixed(3)));break;case"zoomIn":d.value.scale<z&&(d.value.scale=Number.parseFloat((d.value.scale*R).toFixed(3)));break;case"clockwise":d.value.deg+=k,t("rotate",d.value.deg);break;case"anticlockwise":d.value.deg-=k,t("rotate",d.value.deg);break}d.value.enableTransition=N}return fe(Y,()=>{Ie(()=>{const r=S.value[0];r!=null&&r.complete||(w.value=!0)})}),fe(f,r=>{ne(),t("switch",r)}),Ee(()=>{var r,l;j(),(l=(r=y.value)==null?void 0:r.focus)==null||l.call(r)}),s({setActiveItem:Z}),(r,l)=>(L(),me(Ke,{to:"body",disabled:!r.teleported},[p(je,{name:"viewer-fade",appear:""},{default:$(()=>[x("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:h(n(o).e("wrapper")),style:ve({zIndex:V.value})},[x("div",{class:h(n(o).e("mask")),onClick:l[0]||(l[0]=$e(m=>r.hideOnClickModal&&T(),["self"]))},null,2),A(" CLOSE "),x("span",{class:h([n(o).e("btn"),n(o).e("close")]),onClick:T},[p(n(D),null,{default:$(()=>[p(n(Ae))]),_:1})],2),A(" ARROW "),n(F)?A("v-if",!0):(L(),B(ie,{key:0},[x("span",{class:h(n(W)),onClick:re},[p(n(D),null,{default:$(()=>[p(n(Be))]),_:1})],2),x("span",{class:h(n(c)),onClick:a},[p(n(D),null,{default:$(()=>[p(n(Me))]),_:1})],2)],64)),A(" ACTIONS "),x("div",{class:h([n(o).e("btn"),n(o).e("actions")])},[x("div",{class:h(n(o).e("actions__inner"))},[p(n(D),{onClick:l[1]||(l[1]=m=>g("zoomOut"))},{default:$(()=>[p(n(Ve))]),_:1}),p(n(D),{onClick:l[2]||(l[2]=m=>g("zoomIn"))},{default:$(()=>[p(n(Fe))]),_:1}),x("i",{class:h(n(o).e("actions__divider"))},null,2),p(n(D),{onClick:ae},{default:$(()=>[(L(),me(De(n(M).icon)))]),_:1}),x("i",{class:h(n(o).e("actions__divider"))},null,2),p(n(D),{onClick:l[3]||(l[3]=m=>g("anticlockwise"))},{default:$(()=>[p(n(Pe))]),_:1}),p(n(D),{onClick:l[4]||(l[4]=m=>g("clockwise"))},{default:$(()=>[p(n(Xe))]),_:1})],2)],2),A(" CANVAS "),x("div",{class:h(n(o).e("canvas"))},[(L(!0),B(ie,null,Ye(r.urlList,(m,z)=>We((L(),B("img",{ref_for:!0,ref:R=>S.value[z]=R,key:m,src:m,style:ve(n(b)),class:h(n(o).e("img")),crossorigin:r.crossorigin,onLoad:J,onError:ee,onMousedown:te},null,46,bt)),[[He,z===f.value]])),128))],2),se(r.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Et=Se(It,[["__file","image-viewer.vue"]]);const St=_e(Et),_t=we({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:G([String,Object])},previewSrcList:{type:G(Array),default:()=>he([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:G(String)}}),xt={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>de(e),close:()=>!0,show:()=>!0},Lt=["src","loading","crossorigin"],Ct={key:0},Tt=le({name:"ElImage",inheritAttrs:!1}),zt=le({...Tt,props:_t,emits:xt,setup(e,{emit:s}){const t=e;let u="";const{t:i}=be(),v=ke("image"),O=Ue(),o=tt(),I=C(),y=C(!1),S=C(!0),_=C(!1),w=C(),f=C(),M=P&&"loading"in HTMLImageElement.prototype;let d,V;const F=E(()=>[v.e("inner"),Y.value&&v.e("preview"),S.value&&v.is("loading")]),X=E(()=>O.style),H=E(()=>{const{fit:a}=t;return P&&a?{objectFit:a}:{}}),Y=E(()=>{const{previewSrcList:a}=t;return Array.isArray(a)&&a.length>0}),W=E(()=>{const{previewSrcList:a,initialIndex:g}=t;let r=g;return g>a.length-1&&(r=0),r}),c=E(()=>t.loading==="eager"?!1:!M&&t.loading==="lazy"||t.lazy),b=()=>{P&&(S.value=!0,y.value=!1,I.value=t.src)};function T(a){S.value=!1,y.value=!1,s("load",a)}function j(a){S.value=!1,y.value=!0,s("error",a)}function Q(){nt(w.value,f.value)&&(b(),te())}const J=et(Q,200,!0);async function ee(){var a;if(!P)return;await Ie();const{scrollContainer:g}=t;Ge(g)?f.value=g:Qe(g)&&g!==""?f.value=(a=document.querySelector(g))!=null?a:void 0:w.value&&(f.value=yt(w.value)),f.value&&(d=U(f,"scroll",J),setTimeout(()=>Q(),100))}function te(){!P||!f.value||!J||(d==null||d(),f.value=void 0)}function ne(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function ae(){Y.value&&(V=U("wheel",ne,{passive:!1}),u=document.body.style.overflow,document.body.style.overflow="hidden",_.value=!0,s("show"))}function Z(){V==null||V(),document.body.style.overflow=u,_.value=!1,s("close")}function re(a){s("switch",a)}return fe(()=>t.src,()=>{c.value?(S.value=!0,y.value=!1,te(),ee()):b()}),Ee(()=>{c.value?ee():b()}),(a,g)=>(L(),B("div",{ref_key:"container",ref:w,class:h([n(v).b(),a.$attrs.class]),style:ve(n(X))},[y.value?se(a.$slots,"error",{key:0},()=>[x("div",{class:h(n(v).e("error"))},Je(n(i)("el.image.error")),3)]):(L(),B(ie,{key:1},[I.value!==void 0?(L(),B("img",Ze({key:0},n(o),{src:I.value,loading:a.loading,style:n(H),class:n(F),crossorigin:a.crossorigin,onClick:ae,onLoad:T,onError:j}),null,16,Lt)):A("v-if",!0),S.value?(L(),B("div",{key:1,class:h(n(v).e("wrapper"))},[se(a.$slots,"placeholder",{},()=>[x("div",{class:h(n(v).e("placeholder"))},null,2)])],2)):A("v-if",!0)],64)),n(Y)?(L(),B(ie,{key:2},[_.value?(L(),me(n(St),{key:0,"z-index":a.zIndex,"initial-index":n(W),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:Z,onSwitch:re},{default:$(()=>[a.$slots.viewer?(L(),B("div",Ct,[se(a.$slots,"viewer")])):A("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):A("v-if",!0)],64)):A("v-if",!0)],6))}});var Nt=Se(zt,[["__file","image.vue"]]);const $t=_e(Nt);export{$t as E,ce as t};
